# ğŸ¨ Module 3: Design Patterns AvancÃ©s

## ğŸ¯ Votre Mission (3h)

**Construire un Consultant IA E-commerce - Ã‰cosystÃ¨me d'Agents Experts**

Ã€ la fin de ce module, vous aurez crÃ©Ã© un systÃ¨me complet qui :
- âœ… **Analyse les donnÃ©es** : RAG Agent sur votre base de connaissances e-commerce
- âœ… **Collabore intelligemment** : 6 agents experts (Planning, Marketing, Tech, Finance, Quality, System)
- âœ… **S'auto-corrige** : DÃ©tection d'erreurs + corrections automatiques + learning
- âœ… **Planifie automatiquement** : DÃ©composition mission â†’ orchestration â†’ optimisation
- âœ… **Coordonne globalement** : Architecture distribuÃ©e avec performance monitoring

## ğŸš€ Le Projet Concret que Vous Allez Construire

### ğŸ¯ **Consultant IA E-commerce - "OptiCommerce Pro"**

**Votre systÃ¨me final :**
```
ğŸ‘¤ USER: "Optimisez notre stratÃ©gie e-commerce pour Q1 2025"

ğŸ¤– VOTRE CONSULTANT IA:
1. ğŸ“‹ Planning Agent â†’ DÃ©compose en 4 phases stratÃ©giques
2. ğŸ” RAG Agent â†’ Analyse vos donnÃ©es + tendances marchÃ©  
3. ğŸ‘¥ Ã‰quipe Collaborative â†’ Marketing + Tech + Finance nÃ©gocient
4. ğŸ”„ Self-Correction â†’ Valide cohÃ©rence + corrige erreurs
5. ğŸŒ System Coordinator â†’ Optimise globalement

ğŸ“Š RÃ‰SULTAT: StratÃ©gie complÃ¨te validÃ©e en 18 minutes
ğŸ“ LIVRABLES: PDF 45 pages + Excel budget + Roadmap JSON
```

### ğŸ† **Ce Que Votre SystÃ¨me Saura Faire**

**ScÃ©nario concret :** Vous avez un e-commerce B2B, conversion 12%, objectif +25% Q1
- **Analyse intelligente** : DonnÃ©es historiques + benchmark concurrents â†’ insights
- **Consensus multi-expertise** : Marketing (vidÃ©o mobile) + Tech (IA perso) + Finance (ROI 3.8x)
- **Auto-validation** : Budget trop agressif dÃ©tectÃ© â†’ correction automatique
- **Livrables business** : Strategy PDF + Timeline 16 semaines + Budget optimisÃ©

## ğŸ“‹ PrÃ©requis Techniques

Avant de commencer ce module avancÃ©, assurez-vous d'avoir :

### âœ… **Niveau Python Expert Requis**
- **Python expert** : MÃ©taclasses, async/await, context managers
- **Architecture** : Design patterns, SOLID principles
- **Concurrence** : Threading, multiprocessing, asyncio
- **Performance** : Profiling, optimisation mÃ©moire/CPU

### âœ… **Connaissances Obligatoires**
- **Modules 1 & 2 complÃ©tÃ©s** avec score â‰¥80% chacun
- **Production systems** : Monitoring, logging, error handling
- **Distributed systems** : Microservices, message queues (concepts)
- **Data engineering** : ETL, vectorization, embeddings

### âš ï¸ **PrÃ©requis Critiques**
- âœ… **Module 1 & 2 maÃ®trisÃ©s** : Vous devez avoir construit au moins 2 agents complets
- âœ… **Python 3.10+** avec librairies scientifiques (numpy, pandas)
- âœ… **32GB RAM recommandÃ©** pour systÃ¨mes multi-agents complexes
- âœ… **APIs multiples** configurÃ©es (OpenAI + backup provider)

### ğŸ› ï¸ **Infrastructure Technique**
- **Ressources** : Machine puissante ou accÃ¨s cloud computing
- **Storage** : SSD avec 10GB+ espace libre
- **Network** : Connexion trÃ¨s stable (upload/download Ã©levÃ©)
- **Monitoring** : Tools pour observer performance systÃ¨me

### ğŸ§  **Connaissances Business**
- **E-commerce** : MÃ©triques (conversion, CAC, LTV), KPIs business
- **Consulting** : Frameworks d'analyse (BCG, McKinsey), structuration recommandations
- **Strategy** : Planification, budgets, roadmaps

### ğŸ“š **Si PrÃ©requis Manquants**
**STOP** - Retournez complÃ©ter les modules prÃ©cÃ©dents d'abord :
- [Module 1](../01-fondamentaux/) si patterns de base non maÃ®trisÃ©s
- [Module 2](../02-frameworks/) si expÃ©rience frameworks insuffisante
- [Python Architecture](https://realpython.com/python-application-layouts/) pour design patterns

## ğŸ“š Les 5 Patterns AvancÃ©s que Vous MaÃ®triserez

1. âœ… **Multi-Agent Collaboration** â†’ Ã‰quipes spÃ©cialisÃ©es qui nÃ©gocient
2. âœ… **Self-Correction** â†’ Auto-dÃ©tection erreurs + corrections + learning  
3. âœ… **RAG Agent** â†’ Knowledge base propriÃ©taire + recherche sÃ©mantique
4. âœ… **Planning Agent** â†’ DÃ©composition automatique + orchestration adaptive
5. âœ… **Multi-Agent System** â†’ Architecture distribuÃ©e + coordination globale

## ğŸ§© Pourquoi Ces Patterns?

### **Ã‰prouvÃ©s en Production**
- **OpenAI ChatGPT** â†’ Tool Use + RAG + Self-Correction
- **GitHub Copilot** â†’ Planning Agent + Code Generation
- **Microsoft Cortana** â†’ Multi-Agent System + Human-in-Loop
- **Google Assistant** â†’ Single Agent + Tool Use + RAG

### **Couvrent 95% des Cas d'Usage**
- **Support Client** â†’ RAG + Human-in-Loop + Self-Correction
- **DÃ©veloppement** â†’ Planning + Tool Use + Multi-Agent
- **Marketing** â†’ Multi-Agent Collaboration + Content Generation
- **Recherche** â†’ RAG + Planning + Multi-Agent System

## ğŸ“‚ Structure du Module

```
03-design-patterns/
â”œâ”€â”€ README.md                              # Ce guide
â”œâ”€â”€ my_advanced_agent_system_starter.py   # ğŸ¯ Template principal avec TODOs guidÃ©s
â”œâ”€â”€ STEP_BY_STEP_GUIDE.md                  # ğŸ“– Guide d'apprentissage progressif
â””â”€â”€ [Fichiers gÃ©nÃ©rÃ©s]                     # ğŸ“„ Outputs du projet (auto-gÃ©nÃ©rÃ©s)
```

### ğŸ“ Approche PÃ©dagogique
Ce module utilise l'**apprentissage par projet** : vous apprenez les 5 patterns avancÃ©s en construisant un Ã©cosystÃ¨me d'agents collaboratifs avec 15 Ã©tapes guidÃ©es.

ğŸ’¡ **PrÃ©requis** : Les patterns de base (Single Agent, Tool Use, Human-in-Loop) sont couverts dans le Module 1.

## ğŸ¬ Votre Ã‰cosystÃ¨me d'Agents AvancÃ©s en Action

### ğŸ¤– **Ce que Vous Construirez ConcrÃ¨tement**

**DÃ©monstration avec mission "Analyser et optimiser notre stratÃ©gie e-commerce"** :

```
ğŸ¯ USER: "Optimisez notre stratÃ©gie e-commerce pour Q1 2025"

ğŸŒ Ã‰COSYSTÃˆME MULTI-AGENTS AVANCÃ‰S:

ğŸ“‹ Planning Agent (Orchestrateur):
   "Mission complexe dÃ©tectÃ©e â†’ DÃ©composition automatique:
   1. [RAG] Analyser donnÃ©es historiques + tendances marchÃ©
   2. [Multi-Agent] Ã‰quipe spÃ©cialisÃ©e marketing + tech + finance  
   3. [Self-Correction] Validation croisÃ©e + amÃ©lioration continue
   4. [Multi-Agent System] Coordination globale + optimisation"

ğŸ” RAG Agent (Knowledge):
   "Recherche dans base de connaissances:
   âœ… Analytics Q3-Q4 2024: conversion +12%, panier moyen â‚¬87
   âœ… Tendances secteur: mobile-first, vidÃ©o produit, IA personnalisation
   âœ… Benchmark concurrents: prix -8%, marketing social +34%"

ğŸ‘¥ Multi-Agent Collaboration (Ã‰quipe):
   
   ğŸ“Š Marketing Agent: "StratÃ©gie basÃ©e sur RAG findings:
      - Video content mobile-first (67% trafic mobile)
      - Personnalisation IA (boost conversion +23%)
      - Social commerce Instagram/TikTok"
   
   ğŸ’» Tech Agent: "Architecture recommandÃ©e:
      - Moteur de recommandation IA
      - Optimisation mobile (Core Web Vitals)
      - A/B testing automatisÃ©"
   
   ğŸ’° Finance Agent: "Budget optimal Q1:
      - Marketing digital: â‚¬85k (ROI projetÃ© 4.2x)
      - Tech dÃ©veloppement: â‚¬35k  
      - Inventory optimization: â‚¬25k"

ğŸ”„ Self-Correction Agent (Quality):
   "Auto-validation des recommandations:
   âŒ Budget marketing trop agressif vs historical ROI
   âœ… Correction: â‚¬65k marketing + â‚¬15k contingence
   âœ… Validation croisÃ©e: cohÃ©rence recommandations Ã©quipe"

ğŸŒ Multi-Agent System (Coordination):
   "SynthÃ¨se globale optimisÃ©e:
   
   ğŸ“ˆ STRATÃ‰GIE INTÃ‰GRÃ‰E Q1:
   1. Mobile-first redesign (Tech) + Video content (Marketing) 
   2. IA personnalisation (Tech) + Social commerce (Marketing)
   3. Budget optimisÃ© â‚¬145k (Finance) avec ROI 3.8x validÃ©
   
   ğŸ“Š MÃ‰TRIQUES CIBLES:
   - Conversion mobile: +25% (vs +12% actuel)
   - Panier moyen: â‚¬95 (vs â‚¬87 actuel)  
   - CAC: -15% via optimisations IA"

ğŸ“ LIVRABLES AUTOMATIQUES:
   "Strategie_Ecommerce_Q1_2025_Complete.pdf" - 45 pages dÃ©taillÃ©es
   "Implementation_Roadmap.json" - timeline 16 semaines
   "Budget_Allocation_Optimized.xlsx" - breakdown mensuel
   "Agent_Collaboration_Log.md" - historique dÃ©cisions

â±ï¸ Temps total: 18 minutes | ğŸ¤– 6 agents | ğŸ”„ 3 auto-corrections | âœ… Validation croisÃ©e
```

### ğŸ† **RÃ©sultat Final Concret**

Ã€ la fin, vous aurez un **Ã©cosystÃ¨me d'agents avancÃ©s** qui :
- **Planification intelligente** : DÃ©composition automatique â†’ orchestration â†’ validation
- **Knowledge management** : RAG sur donnÃ©es propriÃ©taires â†’ insights contextuels  
- **Collaboration experte** : SpÃ©cialistes mÃ©tier â†’ consensus â†’ optimisation croisÃ©e
- **Auto-amÃ©lioration** : DÃ©tection erreurs â†’ correction â†’ learning continu
- **Architecture distribuÃ©e** : Coordination globale â†’ scalabilitÃ© â†’ performance

## ğŸ¯ Guide de Choix des Patterns AvancÃ©s

ğŸ’¡ **Important** : Ces patterns nÃ©cessitent une maÃ®trise des patterns de base (Module 1)

### **ğŸ¤ Multi-Agent Collaboration** - Division du Travail
**Quand l'utiliser** :
- TÃ¢che complexe nÃ©cessitant plusieurs expertises
- Pipeline sÃ©quentiel clair
- Besoin de spÃ©cialisation

**Exemples** :
- Recherche â†’ Analyse â†’ RÃ©daction
- Code Review â†’ Testing â†’ Documentation
- Market Research â†’ Strategy â†’ Content

**Metrics d'impact** : QualitÃ© outputs, temps total

---


### **ğŸ”„ Self-Correction** - AmÃ©lioration Continue
**Quand l'utiliser** :
- Output de qualitÃ© variable
- PossibilitÃ© d'auto-validation
- AmÃ©lioration itÃ©rative possible

**Exemples** :
- GÃ©nÃ©ration de code avec tests
- Ã‰criture avec fact-checking
- Traduction avec validation

**Metrics d'impact** : Taux d'erreur, qualitÃ© finale

---


### **ğŸ“š RAG Agent** - Intelligence Documentaire
**Quand l'utiliser** :
- Large base de connaissances
- Information spÃ©cialisÃ©e/propriÃ©taire
- Besoin de sources/citations

**Exemples** :
- Support technique avec docs
- Assistant juridique avec jurisprudence
- Consultant avec rapports internes

**Metrics d'impact** : Pertinence rÃ©ponses, citations correctes

---

### **ğŸ—“ï¸ Planning Agent** - DÃ©composition Complexe
**Quand l'utiliser** :
- Objectifs multi-Ã©tapes
- DÃ©pendances entre tÃ¢ches
- Planification stratÃ©gique

**Exemples** :
- Gestion de projet
- StratÃ©gie marketing complÃ¨te
- Architecture technique

**Metrics d'impact** : Respect timeline, complÃ©tude plan

---

### **ğŸŒ Multi-Agent System** - Architecture DistribuÃ©e
**Quand l'utiliser** :
- SystÃ¨me trÃ¨s complexe
- Agents autonomes nÃ©cessaires
- ScalabilitÃ© importante

**Exemples** :
- Plateforme complÃ¨te (Ã©quipe virtuelle)
- Simulation d'organisations
- Ã‰cosystÃ¨me d'agents spÃ©cialisÃ©s

**Metrics d'impact** : Performance systÃ¨me, coordination

## ğŸš€ DÃ©marrage du Projet

### ğŸ“– Guide Complet d'Apprentissage

1. **Lisez le guide Ã©tape par Ã©tape** : [`STEP_BY_STEP_GUIDE.md`](./STEP_BY_STEP_GUIDE.md)
2. **Ouvrez le template** : [`my_advanced_agent_system_starter.py`](./my_advanced_agent_system_starter.py)
3. **Suivez les 15 TODOs** dans l'ordre pour apprendre

### ğŸ¯ Progression d'Apprentissage

```bash
# 1. Installer et configurer
pip install openai chromadb sentence-transformers langchain-community faiss-cpu
cp .env.example .env  # Ajouter votre OPENAI_API_KEY

# 2. Lancer le template
python my_advanced_agent_system_starter.py

# 3. Suivre les TODOs dans l'ordre :
#    TODO 1-3: Architecture et setup avancÃ©s
#    TODO 4-6: RAG Agent et knowledge management
#    TODO 7-9: Multi-Agent Collaboration
#    TODO 10-12: Self-Correction et Planning
#    TODO 13-15: Multi-Agent System et intÃ©gration
```

### ğŸ“š Ce que Vous Apprendrez

| TODO | Pattern | DurÃ©e |
|------|---------|-------|
| 1-3 | **Architecture avancÃ©e** - Setup et messaging inter-agents | 25 min |
| 4-6 | **RAG Agent** - Knowledge base et recherche sÃ©mantique | 40 min |
| 7-9 | **Multi-Agent Collaboration** - Ã‰quipes spÃ©cialisÃ©es | 45 min |
| 10-12 | **Self-Correction + Planning** - Auto-amÃ©lioration et orchestration | 40 min |
| 13-15 | **Multi-Agent System** - Architecture distribuÃ©e complÃ¨te | 40 min |

## ğŸ“ Projet Final : Ã‰cosystÃ¨me E-commerce Intelligent

**ğŸ¯ Mission** : Construire un systÃ¨me complet d'optimisation e-commerce  
**ğŸ“‹ Livrables concrets** :
- âœ… **6 agents spÃ©cialisÃ©s** : Planning â†’ RAG â†’ Marketing â†’ Tech â†’ Finance â†’ Self-Correction
- âœ… **Base de connaissances** : Analytics historiques + tendances marchÃ© â†’ insights contextuels
- âœ… **Collaboration intelligente** : Consensus multi-expertises â†’ recommandations validÃ©es  
- âœ… **Auto-amÃ©lioration** : DÃ©tection incohÃ©rences â†’ corrections â†’ learning
- âœ… **Orchestration globale** : Coordination â†’ optimisation â†’ livrables business
- ğŸ“„ **DÃ©monstration** : Mission complexe â†’ dÃ©composition â†’ exÃ©cution â†’ rÃ©sultats mesurables
- ğŸ“ **Fichiers gÃ©nÃ©rÃ©s** : Strategy PDF + Roadmap JSON + Budget Excel + Collaboration Log

## âœ… Validation des CompÃ©tences

### âœ… **CritÃ¨res de RÃ©ussite**

Votre projet est rÃ©ussi quand vous avez complÃ©tÃ© **tous les TODOs** et votre Ã©cosystÃ¨me :

#### ğŸ“Š **Performance** :
- Coordonne 6+ agents spÃ©cialisÃ©s sans conflit
- GÃ©nÃ¨re des stratÃ©gies cohÃ©rentes en <20 minutes
- Auto-corrige les incohÃ©rences dÃ©tectÃ©es

#### ğŸ¯ **FonctionnalitÃ©s** :
- **RAG Agent** : Base de connaissances + recherche sÃ©mantique opÃ©rationnelle
- **Multi-Agent Collaboration** : Marketing + Tech + Finance â†’ consensus
- **Self-Correction** : DÃ©tection automatique + corrections + learning
- **Planning Agent** : DÃ©composition intelligente + orchestration adaptive
- **Multi-Agent System** : Architecture distribuÃ©e + coordination globale

#### ğŸ¬ **DÃ©monstration** :
Votre Ã©cosystÃ¨me doit rÃ©ussir l'optimisation e-commerce complÃ¨te avec livrables business.

### ğŸ“ **Fichiers GÃ©nÃ©rÃ©s**

AprÃ¨s complÃ©tion des TODOs, vous aurez crÃ©Ã© :
```
03-design-patterns/
â”œâ”€â”€ my_advanced_agent_system_starter.py   # âœ… Votre implÃ©mentation complÃ¨te
â”œâ”€â”€ Strategie_Ecommerce_Q1_2025_Complete.pdf # âœ… StratÃ©gie dÃ©taillÃ©e (45 pages)
â”œâ”€â”€ Implementation_Roadmap.json              # âœ… Planning 16 semaines
â”œâ”€â”€ Budget_Allocation_Optimized.xlsx        # âœ… Budget breakdown mensuel
â”œâ”€â”€ Agent_Collaboration_Log.md              # âœ… Historique dÃ©cisions
â””â”€â”€ Ecosystem_Performance_Metrics.json     # âœ… MÃ©triques systÃ¨me
```

### ğŸ† **Validation Finale**

Pour valider vos acquis avancÃ©s, vous devez pouvoir :
- [ ] Expliquer l'orchestration des 5 patterns avancÃ©s
- [ ] Modifier l'Ã©cosystÃ¨me pour votre domaine mÃ©tier
- [ ] Diagnostiquer et rÃ©soudre les problÃ¨mes de coordination
- [ ] Analyser les mÃ©triques de performance systÃ¨me
- [ ] Adapter l'architecture pour des cas d'usage complexes

## ğŸ¯ Matrice de DÃ©cision

| Cas d'Usage | ComplexitÃ© | Temps RÃ©el | Validation | Pattern RecommandÃ© |
|-------------|------------|------------|------------|-------------------|
| FAQ Bot | Faible | Oui | Auto | **Single Agent** |
| Code Review | Moyenne | Non | Humaine | **Multi-Agent + Human-in-Loop** |
| Trading | Ã‰levÃ©e | Oui | Critique | **Planning + Self-Correction** |
| Support L3 | Ã‰levÃ©e | Oui | Mixte | **RAG + Tool Use + Human-in-Loop** |
| Research | Ã‰levÃ©e | Non | Auto | **Multi-Agent System + Planning** |

## ğŸš€ Next Steps

Une fois ces patterns maÃ®trisÃ©s, passez au **Module 4: Portfolio Projects** pour les appliquer Ã  des cas concrets avec mÃ©triques business !

---

## ğŸš¨ Troubleshooting - Erreurs SystÃ¨mes AvancÃ©s

### âŒ **Multi-Agent: "Deadlock detected"**
**SymptÃ´me** : Agents se bloquent mutuellement, conversation figÃ©e
**Solution** :
```python
# ImplÃ©mentez un timeout global
import asyncio
try:
    result = await asyncio.wait_for(
        multi_agent_system.execute_mission(mission), 
        timeout=300  # 5 minutes max
    )
except asyncio.TimeoutError:
    # Graceful shutdown et diagnostic
    system.emergency_shutdown()
```

### âŒ **RAG: "Vector dimensions mismatch"**
**SymptÃ´me** : `ValueError: vector dimensions don't match` dans ChromaDB
**Solution** :
```python
# Synchronisez les dimensions d'embeddings
embedding_model = SentenceTransformer('all-MiniLM-L6-v2')  # 384 dims
collection = chroma_client.create_collection(
    name="knowledge_base",
    metadata={"embedding_dimension": 384}
)

# VÃ©rifiez avant l'ajout
vector = embedding_model.encode("test")
print(f"Dimension: {len(vector)}")  # Doit correspondre Ã  la collection
```

### âŒ **Self-Correction: "Infinite correction loop"**
**SymptÃ´me** : Agent corrige en boucle sans converger
**Solution** :
```python
class SelfCorrectionAgent:
    def __init__(self):
        self.max_corrections = 3  # Limite absolue
        self.correction_history = []
    
    def auto_correct(self, issue):
        if len(self.correction_history) >= self.max_corrections:
            return {"status": "max_corrections_reached", "fallback": True}
        # Logique de correction...
```

### âŒ **Planning: "Circular dependencies"**
**SymptÃ´me** : TÃ¢ches qui dÃ©pendent les unes des autres en cercle
**Solution** :
```python
import networkx as nx

def detect_circular_dependencies(plan):
    G = nx.DiGraph()
    for task in plan:
        for dependency in task.get("dependencies", []):
            G.add_edge(dependency, task["id"])
    
    try:
        cycles = list(nx.simple_cycles(G))
        if cycles:
            raise ValueError(f"Circular dependencies detected: {cycles}")
    except nx.NetworkXNoCycle:
        pass  # OK, no cycles
```

### âŒ **System Coordination: "Agent communication failure"**
**SymptÃ´me** : Messages perdus entre agents, coordination Ã©choue
**Solution** :
```python
# ImplÃ©mentez un systÃ¨me de retry robuste
import asyncio
from tenacity import retry, stop_after_attempt, wait_exponential

@retry(stop=stop_after_attempt(3), wait=wait_exponential(multiplier=1, min=4, max=10))
async def send_message_with_retry(sender, recipient, message):
    try:
        return await sender.send_message(recipient, message)
    except Exception as e:
        print(f"Message failed: {e}, retrying...")
        raise
```

### âŒ **Performance: "Memory leak in long sessions"**
**SymptÃ´me** : RAM qui augmente continuellement, systÃ¨me lent
**Solution** :
```python
import gc
import psutil

class PerformanceMonitor:
    def __init__(self):
        self.memory_threshold = 4 * 1024 * 1024 * 1024  # 4GB
    
    def check_memory_usage(self):
        process = psutil.Process()
        memory_usage = process.memory_info().rss
        
        if memory_usage > self.memory_threshold:
            # Cleanup forcÃ©
            gc.collect()
            # Clear conversation histories
            for agent in self.agents.values():
                agent.conversation_history = agent.conversation_history[-10:]  # Keep last 10
```

### ğŸ†˜ **Advanced Debug Strategies**

#### ğŸ” **System-Level Debugging**
```python
# Monitoring complet de l'Ã©cosystÃ¨me
class EcosystemDebugger:
    def __init__(self, system):
        self.system = system
        self.debug_log = []
    
    def log_system_state(self):
        state = {
            "timestamp": datetime.now().isoformat(),
            "active_agents": len([a for a in self.system.agents.values() if a.is_active]),
            "message_queue_size": sum(a.message_queue.qsize() for a in self.system.agents.values()),
            "memory_usage": psutil.Process().memory_info().rss / 1024 / 1024,  # MB
            "coordination_status": self.system.coordinator.status
        }
        self.debug_log.append(state)
        return state
```

#### ğŸ“Š **Performance Profiling**
```python
import cProfile
import pstats
from functools import wraps

def profile_agent_method(func):
    @wraps(func)
    def wrapper(*args, **kwargs):
        profiler = cProfile.Profile()
        profiler.enable()
        result = func(*args, **kwargs)
        profiler.disable()
        
        # Sauvegarde stats
        stats = pstats.Stats(profiler)
        stats.dump_stats(f"profile_{func.__name__}_{datetime.now().strftime('%Y%m%d_%H%M%S')}.prof")
        return result
    return wrapper
```

### ğŸ”§ **Architecture Recovery Patterns**

#### ğŸš¨ **Emergency Shutdown**
```python
def emergency_shutdown(self):
    """ArrÃªt d'urgence sÃ©curisÃ© de l'Ã©cosystÃ¨me"""
    print("ğŸš¨ EMERGENCY SHUTDOWN INITIATED")
    
    # 1. Sauvegarde Ã©tat critique
    self.save_system_state("emergency_backup.json")
    
    # 2. ArrÃªt gracieux des agents
    for agent_id, agent in self.agents.items():
        try:
            agent.graceful_shutdown(timeout=10)
        except Exception as e:
            print(f"Force shutdown {agent_id}: {e}")
    
    # 3. Cleanup resources
    gc.collect()
    print("âœ… Emergency shutdown completed")
```

#### ğŸ”„ **System Recovery**
```python
def recover_from_backup(self, backup_file="emergency_backup.json"):
    """RÃ©cupÃ©ration depuis sauvegarde"""
    try:
        with open(backup_file, 'r') as f:
            backup_state = json.load(f)
        
        # Reconstruit l'Ã©cosystÃ¨me
        self.rebuild_from_state(backup_state)
        print("âœ… System recovered from backup")
        return True
    except Exception as e:
        print(f"âŒ Recovery failed: {e}")
        return False
```

### ğŸ’¡ **Best Practices Debugging AvancÃ©**

1. **ğŸ” Monitoring continu** : Loggez toutes les interactions inter-agents
2. **â±ï¸ Timeouts partout** : Jamais d'attente infinie 
3. **ğŸ”„ Graceful degradation** : Mode dÃ©gradÃ© si composants Ã©chouent
4. **ğŸ’¾ State persistence** : Sauvegarde rÃ©guliÃ¨re pour recovery
5. **ğŸ“Š MÃ©triques temps rÃ©el** : Dashboard de santÃ© systÃ¨me
6. **ğŸš¨ Alertes automatiques** : DÃ©tection proactive des problÃ¨mes

ğŸ’¡ **Pattern Philosophy**: Start simple, add complexity only when needed. Every pattern has its place, but simplicity beats complexity when both solve the problem.